{"version":3,"sources":["../src/index.ts","../src/createLitebook.ts"],"sourcesContent":["#!/usr/bin/env node\r\nimport fs from \"fs-extra\";\r\nimport { createLitebook } from \"./createLitebook.js\";\r\n\r\nconst main = async () => {\r\n  // Write name to package.json\r\n  const pkgJson = fs.readJSONSync(\"package.json\");\r\n  pkgJson.scripts = {\r\n    ...pkgJson.scripts,\r\n    litebook: \"vite serve .litebook\",\r\n    \"litebook:build\": \"vite build .litebook\",\r\n  };\r\n  fs.writeJSONSync(\"package.json\", pkgJson, {\r\n    spaces: 2,\r\n  });\r\n  try {\r\n    createLitebook();\r\n  } catch (error) {\r\n    process.stdout.write(\"Litebook already initialized in this repo\");\r\n  }\r\n\r\n  process.exit(0);\r\n};\r\n\r\nmain().catch((err) => {\r\n  process.stderr.write(\"Aborting installation...\");\r\n  if (err instanceof Error) {\r\n    process.stderr.write(JSON.stringify(err));\r\n  } else {\r\n    process.stderr.write(\r\n      \"An unknown error has occurred. Please open an issue on github with the below:\"\r\n    );\r\n    process.stdout.write(err);\r\n  }\r\n  process.exit(1);\r\n});\r\n","import fs from \"fs-extra\";\r\nimport * as TF from \"template-file\";\r\nimport glob from \"glob\";\r\n\r\nexport const createLitebook = async () => {\r\n  let storiesInUsersProject: string[] = [];\r\n\r\n  glob(\"**/*.stories.tsx\", {}, function (_, files) {\r\n    storiesInUsersProject = [...files];\r\n  });\r\n\r\n  fs.mkdirSync(\".litebook\");\r\n  fs.writeFileSync(\r\n    \".litebook/index.html\",\r\n    await TF.renderFile(\"./templates/index.html\", {})\r\n  );\r\n  fs.writeFileSync(\r\n    \".litebook/index.tsx\",\r\n    await TF.renderFile(\"./templates/index.tsx\", {})\r\n  );\r\n  fs.writeFileSync(\r\n    \".litebook/tsconfig.json\",\r\n    await TF.renderFile(\"./templates/tsconfig.json\", {})\r\n  );\r\n  fs.writeFileSync(\r\n    \".litebook/public/logo.svg\",\r\n    await TF.renderFile(\"./templates/public/logo.svg\", {})\r\n  );\r\n  fs.writeFileSync(\r\n    \".litebook/vite.config.ts\",\r\n    await TF.renderFile(\"./templates/vite.config.ts\", {\r\n      stories: storiesInUsersProject.map((st) => ({\r\n        lower: st.toLowerCase(),\r\n        capitalize: st,\r\n      })),\r\n    })\r\n  );\r\n\r\n  // Stories\r\n  fs.mkdirSync(\".litebook/stories\");\r\n  storiesInUsersProject.forEach(async (st) => {\r\n    fs.writeFileSync(\r\n      `.litebook/stories/${st}/iframe.tsx`,\r\n      await TF.renderFile(`./templates/stories/Component/iframe.tsx`, {\r\n        name: st,\r\n      })\r\n    );\r\n  });\r\n};\r\n"],"mappings":";AACA,OAAOA,MAAQ,WCDf,OAAOC,MAAQ,WACf,UAAYC,MAAQ,gBACpB,OAAOC,MAAU,OAEV,IAAMC,EAAiB,SAAY,CACxC,IAAIC,EAAkC,CAAC,EAEvCF,EAAK,mBAAoB,CAAC,EAAG,SAAUG,EAAGC,EAAO,CAC/CF,EAAwB,CAAC,GAAGE,CAAK,CACnC,CAAC,EAEDN,EAAG,UAAU,WAAW,EACxBA,EAAG,cACD,uBACA,MAAS,aAAW,yBAA0B,CAAC,CAAC,CAClD,EACAA,EAAG,cACD,sBACA,MAAS,aAAW,wBAAyB,CAAC,CAAC,CACjD,EACAA,EAAG,cACD,0BACA,MAAS,aAAW,4BAA6B,CAAC,CAAC,CACrD,EACAA,EAAG,cACD,4BACA,MAAS,aAAW,8BAA+B,CAAC,CAAC,CACvD,EACAA,EAAG,cACD,2BACA,MAAS,aAAW,6BAA8B,CAChD,QAASI,EAAsB,IAAKG,IAAQ,CAC1C,MAAOA,EAAG,YAAY,EACtB,WAAYA,CACd,EAAE,CACJ,CAAC,CACH,EAGAP,EAAG,UAAU,mBAAmB,EAChCI,EAAsB,QAAQ,MAAOG,GAAO,CAC1CP,EAAG,cACD,qBAAqBO,eACrB,MAAS,aAAW,2CAA4C,CAC9D,KAAMA,CACR,CAAC,CACH,CACF,CAAC,CACH,ED5CA,IAAMC,EAAO,SAAY,CAEvB,IAAMC,EAAUC,EAAG,aAAa,cAAc,EAC9CD,EAAQ,QAAU,CAChB,GAAGA,EAAQ,QACX,SAAU,uBACV,iBAAkB,sBACpB,EACAC,EAAG,cAAc,eAAgBD,EAAS,CACxC,OAAQ,CACV,CAAC,EACD,GAAI,CACFE,EAAe,CACjB,MAAE,CACA,QAAQ,OAAO,MAAM,2CAA2C,CAClE,CAEA,QAAQ,KAAK,CAAC,CAChB,EAEAH,EAAK,EAAE,MAAOI,GAAQ,CACpB,QAAQ,OAAO,MAAM,0BAA0B,EAC3CA,aAAe,MACjB,QAAQ,OAAO,MAAM,KAAK,UAAUA,CAAG,CAAC,GAExC,QAAQ,OAAO,MACb,+EACF,EACA,QAAQ,OAAO,MAAMA,CAAG,GAE1B,QAAQ,KAAK,CAAC,CAChB,CAAC","names":["fs","fs","TF","glob","createLitebook","storiesInUsersProject","_","files","st","main","pkgJson","fs","createLitebook","err"]}